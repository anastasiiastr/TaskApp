DROP TABLE IF EXISTS roles;
DROP TABLE IF EXISTS tasks;
DROP TABLE IF EXISTS users;

CREATE TABLE IF NOT EXISTS users
(
    id       BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    name     VARCHAR(255)                            NOT NULL,
    password VARCHAR(255)                            NOT NULL,
    active   BOOLEAN                                 NOT NULL,
    role     SMALLINT                                NOT NULL,
    CONSTRAINT pk_users PRIMARY KEY (id)
);

ALTER TABLE users
    ADD CONSTRAINT uc_users_name UNIQUE (name);

CREATE TABLE IF NOT EXISTS tasks
(
    id      BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    text    VARCHAR(255),
    tag     VARCHAR(255),
    user_id BIGINT,
    CONSTRAINT pk_tasks PRIMARY KEY (id)
);

ALTER TABLE tasks
    ADD CONSTRAINT FK_TASKS_ON_USER FOREIGN KEY (user_id) REFERENCES users (id);

CREATE TABLE IF NOT EXISTS roles
(
    id      BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    user_id BIGINT,
    roles   SMALLINT,
    CONSTRAINT pk_roles PRIMARY KEY (id)
);

CREATE TABLE favourites
(
    id      BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    user_id BIGINT,
    task_id BIGINT,
    CONSTRAINT pk_favourites PRIMARY KEY (id)
);
